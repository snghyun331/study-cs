# BDD

**Behavior Driven Development - 행동 주도 개발**

<br/>

✅ TDD의 한 종류로, **사용자의 행위**까지 생각하고 테스트하며 개발하는 방식

✅ 즉 **시나리오**를 기반으로 테스트 케이스를 작성하며 함수 단위 테스트를 권장하지 않는다.

✅ BDD를 통해 개발을 하게 된다면 테스트 메소드의 이름을 "**이  클래스가 어떤 행위를 해야한다 (should do someting)**" 라는 식의 문장으로 작성하여 행위에 대한 테스트에 집중할 수  있다.

<br/>

> *“코드를 작성하기 전에 코드가 수행할 행위에 대한 명세를 먼저 작성해야 한다고 하면 다들 쉽게 이것이 좋은 습관이라고 수긍하게 되지 않을까? 아직 존재하지 않은 코드에 대해 테스트를 작성하기 보다는, 행위에 대한 명세를 작성하는 것이라고 생각하면 직관적으로 쉽게 이해가 된다. 이것이 `BDD`의 핵심이다.”*
> 

<br/>

**BDD Testcase에서 사용하는 디자인 패턴**

- **Feature : 테스트에 대상의 기능/책임을 명시**
- **Scenario : 테스트 목적에 대한 상황을 설명**
- ⭐**Given : 테스트 하기 위해 기본적으로 세팅하는 값 (어떤 상황이 주여졌을 때)**
    - 예) 본인 인증된 사용자가 로그인된 상황에서
- ⭐**When : 테스트를 하기 위한 조건을 지정**
    - 예) 검수 정보를 입력하고 검수 등록 버튼을 누르면
    - 예) 검수 정보를 미입력하고 검수 등록 버튼을 누르면
- ⭐**Then : 테스트 하기 위한 행위가 예상대로 동작하는지 수행 결과를 판단 및 검증**
    - 예) 등록 결과가 포함된 검수 진행 목록 화면으로 이동한다.
    - 예) 검수 등록 실패 사유가 화면에 표시되어야 한다.

<br/>

📌 테스트 대상은 A 상태에서 출발하여(**Given**) 어떤 상태 변화를 가했을 때(**When**) 기대하는 상태로 완료되어야한다(**Then**)

<br/>

## TDD vs BDD

✔ TDD는 작은 단위의 테스트 케이스들을 지속적으로 수정하고 유지보수를 해야되는 데 일정관리나 리소스 측면에서 부담이 되고 귀찮기 때문에 많이 사용하지 않는다.

✔ Given-When-Then을 포함한 기획서에 기반한 테스트 케이스 작성 후 코드를 짜고 코드에 대한 테스트를 수행하는 것이 BDD이다.

<br/>

**테스트 목적의 관점에서도 차이가 있다.**

✔ TDD의 테스트 케이스는 테스트할 모듈의 기능을 확인하는 관점에서 작성되고 BDD의 테스트 케이스는 시나리오의 행위를 확인하는 관점에서 작성된다.

![Untitled (3)](https://github.com/snghyun331/study-cs/assets/108854903/4561140d-6366-48d4-b45e-59bf519bad05)


- TDD 예시 : add 함수의 입력 값과 그에 따른 기대치 결과 값에 대한 검증
- BDD 예시 : 사용자가 더하기의 결과를 얻기 위해 “숫자 입력 → + 누름 → 숫자 입력 → = 누름” 행위를 할 때 두 값의 합이 표시되는지 확인

<br/>

**TDD와 BDD는 상호보완적인 관계이다.**

![Untitled (4)](https://github.com/snghyun331/study-cs/assets/108854903/6fe2e919-9587-42ae-a5ba-b719b817afe9)


BDD의 테스트 케이스로 시나리오 검증을 하고 해당 시나리오에서 사용되는 각 모듈들은 TDD의 테스트케이스로 검증해야 기대하는 테스트 커버리지를 얻을 수 있다.

<br/>

> **결론: TDD와 BDD 방식 모두 필요하고, 둘 중 하나만 쓰는 방법은 비추천한다**
> 

<br/>

**TDD와 비교했을 때 BDD의 장점은?**

![Untitled (5)](https://github.com/snghyun331/study-cs/assets/108854903/1cb4bc30-aebf-4371-af81-70b66b0b8776)


- BDD는 기획 시나리오들의 빈틈들을 테스트 케이스 작성 시에 확인할 수 있는 장점이 있다

<br/>

**설계 누락 케이스를 BDD에서 확인하는 예시**

- **Given**
    - 본인 인증된 사용자가 로그인된 상황에서 <br/>
    ➕ 본인 인증 안된 사용자가 로그인된 상황에서 <br/>
    ➕ 본인 인증이 어려운 미성년 사용자가 로그인된 상황에서
<br/>

**정리**

![Untitled (6)](https://github.com/snghyun331/study-cs/assets/108854903/108fcfb0-58c1-4a9e-b549-d8d8e3ec71eb)


- BDD는 기획서를 통한 테스트 케이스 작성으로 작성에 대한 비용 감소
- TDD보다도 더 넓은 테스트 커버리지 확보 가능
- 설계 변경에 따른 리스크 최소화
- 서비스의 이해도 증가

<br/>

## BDD 스타일 종류

### BehaviorSpec

: **Given / When / Then 구조를 지원하는 BDD용 Style**

```tsx
Given("본인 인증된 사용자가 로그인된 상황에서") {
    ....
    When("검수 정보를 입력란에") {
        ....
        And("검수 정보를 입력하고 검수 등록 버튼을 누르면") {
            ....
            Then("등록 결과가 포함된 검수 진행 목록 화면으로 이동한다") {
                ....
            }
        }

        And("검수 정보를 입력하지 않고 검수 등록 버튼을 누르면") {
            ....
            Then("검수 등록 실패 사유가 화면에 표시되어야 한다") {
                ....
            }
        }
    }
}
```

- And 블록 : 하위 분기
    - 중복된 서술을 재입력하지 않아도 상위에 서술된 동일한 내용을 테스트 케이스 결과에 출력할 수 있다.
    - 같은 상위 코드 블럭을 사용함으로써 변수도 공유할 수 있다.

<br/>

### FeatureSpec

**: Feature / Scenario 구조를 지원하는 BDD용 Style**

```tsx
features("이모티콘 검수 이메일 발송") {
    ....
    scenario("""
        2020-08-05 11:00:00(KST)에 전날 생성된 이모티콘 목록을 
        검수자에게 이메일 발송되어야 한다.
    """) {
        ....
    }
}
```

<br/>
<br/>

## Refrerences

[tv.kakao.com/channel/3693125/cliplink/414004682](https://tv.kakao.com/channel/3693125/cliplink/414004682)

https://beomseok95.tistory.com/293

[https://velog.io/@suhongkim98/TDD-BDD-ATDD-알아보기](https://velog.io/@suhongkim98/TDD-BDD-ATDD-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0)

https://mingule.tistory.com/43
